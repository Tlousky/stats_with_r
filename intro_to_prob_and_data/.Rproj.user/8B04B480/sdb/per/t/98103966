{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Probability\"\noutput: statsr:::statswithr_lab\n---\n\n<div id=\"instructions\">\nComplete all **Exercises**, and submit answers to **Questions** on the Coursera \nplatform.\n</div>\n\n## Hot Hands\n\nBasketball players who make several baskets in succession are described as \nhaving a *hot hand*. Fans and players have long believed in the hot hand \nphenomenon, which refutes the assumption that each shot is independent of the \nnext. However, [a 1985 paper](http://www.sciencedirect.com/science/article/pii/0010028585900106) by Gilovich, Vallone, and Tversky collected evidence\nthat contradicted this belief and showed that successive shots are independent \nevents. This paper started a great controversy that continues to this day, as you can \nsee by Googling *hot hand basketball*.\n\nWe do not expect to resolve this controversy today. However, in this lab we'll \napply one approach to answering questions like this. The goals for this lab are \nto (1) think about the effects of independent and dependent events, (2) learn \nhow to simulate shooting streaks in R, and (3) to compare a simulation to actual\ndata in order to determine if the hot hand phenomenon appears to be real.\n\n## Getting Started\n\n### Load packages\n\nIn this lab we will explore the data using the `dplyr` package and visualize it \nusing the `ggplot2` package for data visualization. The data can be found in the\ncompanion package for this course, `statsr`.\n\nLet's load the packages.\n\n```{r load-packages, message=FALSE}\nlibrary(statsr)\nlibrary(dplyr)\nlibrary(ggplot2)\n```\n\n### Data\n\nOur investigation will focus on the performance of one player: Kobe Bryant of \nthe Los Angeles Lakers. His performance against the Orlando Magic in the 2009 \nNBA finals earned him the title *Most Valuable Player* and many spectators \ncommented on how he appeared to show a hot hand. Let's load some necessary files\nthat we will need for this lab.\n\n```{r load-data}\ndata(kobe_basket)\n```\n\nThis data frame contains 133 observations and 6 variables, where every\nrow records a shot taken by Kobe Bryant. The `shot` variable in this dataset\nindicates whether the shot was a hit (`H`) or a miss (`M`).\n\nJust looking at the string of hits and misses, it can be difficult to gauge \nwhether or not it seems like Kobe was shooting with a hot hand. One way we can \napproach this is by considering the belief that hot hand shooters tend to go on \nshooting streaks. For this lab, we define the length of a shooting streak to be \nthe *number of consecutive baskets made until a miss occurs*.\n\nFor example, in Game 1 Kobe had the following sequence of hits and misses from \nhis nine shot attempts in the first quarter:\n\n\\[ \\textrm{H M | M | H H M | M | M | M} \\]\n\nYou can verify this by viewing the first 8 rows of the data in the data viewer.\n\nWithin the nine shot attempts, there are six streaks, which are separated by a \n\"|\" above. Their lengths are one, zero, two, zero, zero, zero (in order of \noccurrence).\n\n1.  Fill in the blank: A streak length of 1 means one \\_\\_\\_ followed by one miss.\n<ol>\n<li> hit </li>\n<li> miss </li>\n</ol>\n\n\n2.  Fill in the blank: A streak length of 0 means one \\_\\_\\_ which must occur after a \nmiss that ended the preceeding streak.\n<ol>\n<li> hit </li>\n<li> miss </li>\n</ol>\n\nCounting streak lengths manually for all 133 shots would get tedious, so we'll\nuse the custom function `calc_streak` to calculate them, and store the results\nin a data frame called `kobe_streak` as the `length` variable.\n\n```{r calc-streak-kobe}\nkobe_streak <- calc_streak(kobe_basket$shot)\n```\n\nWe can then take a look at the distribution of these streak lengths.\n\n```{r plot-streak-kobe}\nggplot(data = kobe_streak, aes(x = length)) +\n  geom_histogram(binwidth = 1)\n```\n\n3.  Which of the following is false about the distribution of Kobe's streak lengths \nfrom the 2009 NBA finals. \n<ol>\n<li> The distribution of Kobe's streaks is unimodal and right skewed. </li>\n<li> The typical length of a streak is 0 since the median of the distribution is at 0. </li>\n<li> The IQR of the distribution is 1. \n<li> The longest streak of baskets is of length 4. </li>\n<li> The shortest streak is of length 1.</li>\n</ol>\n\n## Compared to What?\n\nWe've shown that Kobe had some long shooting streaks, but are they long enough \nto support the belief that he had hot hands? What can we compare them to?\n\nTo answer these questions, let's return to the idea of *independence*. Two \nprocesses are independent if the outcome of one process doesn't affect the outcome \nof the second. If each shot that a player takes is an independent process, \nhaving made or missed your first shot will not affect the probability that you\nwill make or miss your second shot.\n\nA shooter with a hot hand will have shots that are *not* independent of one \nanother. Specifically, if the shooter makes his first shot, the hot hand model \nsays he will have a *higher* probability of making his second shot.\n\nLet's suppose for a moment that the hot hand model is valid for Kobe. During his\ncareer, the percentage of time Kobe makes a basket (i.e. his shooting \npercentage) is about 45%, or in probability notation,\n\n\\[ P(\\textrm{shot 1 = H}) = 0.45 \\]\n\nIf he makes the first shot and has a hot hand (*not* independent shots), then \nthe probability that he makes his second shot would go up to, let's say, 60%,\n\n\\[ P(\\textrm{shot 2 = H} \\, | \\, \\textrm{shot 1 = H}) = 0.60 \\]\n\nAs a result of these increased probabilites, you'd expect Kobe to have longer \nstreaks. Compare this to the skeptical perspective where Kobe does *not* have a\nhot hand, where each shot is independent of the next. If he hit his first shot,\nthe probability that he makes the second is still 0.45.\n\n\\[ P(\\textrm{shot 2 = H} \\, | \\, \\textrm{shot 1 = H}) = 0.45 \\]\n\nIn other words, making the first shot did nothing to affect the probability that\nhe'd make his second shot. If Kobe's shots are independent, then he'd have the \nsame probability of hitting every shot regardless of his past shots: 45%.\n\nNow that we've phrased the situation in terms of independent shots, let's return\nto the question: how do we tell if Kobe's shooting streaks are long enough to \nindicate that he has hot hands? We can compare his streak lengths to someone\nwithout hot hands: an independent shooter. \n\n## Simulations in R\n\nWhile we don't have any data from a shooter we know to have independent shots, \nthat sort of data is very easy to simulate in R. In a simulation, you set the \nground rules of a random process and then the computer uses random numbers to \ngenerate an outcome that adheres to those rules. As a simple example, you can\nsimulate flipping a fair coin with the following.\n\n```{r head-tail}\ncoin_outcomes <- c(\"heads\", \"tails\")\nsample(coin_outcomes, size = 1, replace = TRUE)\n```\n\nThe vector `outcomes` can be thought of as a hat with two slips of paper in it: \none slip says `heads` and the other says `tails`. The function `sample` draws \none slip from the hat and tells us if it was a head or a tail. \n\nRun the second command listed above several times. Just like when flipping a \ncoin, sometimes you'll get a heads, sometimes you'll get a tails, but in the \nlong run, you'd expect to get roughly equal numbers of each.\n\nIf you wanted to simulate flipping a fair coin 100 times, you could either run \nthe function 100 times or, more simply, adjust the `size` argument, which \ngoverns how many samples to draw (the `replace = TRUE` argument indicates we put\nthe slip of paper back in the hat before drawing again). Save the resulting \nvector of heads and tails in a new object called `sim_fair_coin`.\n\n```{r sim-fair-coin}\nsim_fair_coin <- sample(coin_outcomes, size = 100, replace = TRUE)\n```\n\nTo view the results of this simulation, type the name of the object and then use\n`table` to count up the number of heads and tails.\n\n```{r table-sim-fair-coin}\nsim_fair_coin\ntable(sim_fair_coin)\n```\n\nSince there are only two elements in `outcomes`, the probability that we \"flip\" \na coin and it lands heads is 0.5. Say we're trying to simulate an unfair coin \nthat we know only lands heads 20% of the time. We can adjust for this by adding \nan argument called `prob`, which provides a vector of two probability weights.\n\n```{r sim-unfair-coin}\nsim_unfair_coin <- sample(coin_outcomes, size = 100, replace = TRUE, \n                          prob = c(0.2, 0.8))\n```\n\n`prob = c(0.2, 0.8)` indicates that for the two elements in the `outcomes` vector,\nwe want to select the first one, `heads`, with probability 0.2 and the second \none, `tails` with probability 0.8. Another way of thinking about this is to \nthink of the outcome space as a bag of 10 chips, where 2 chips are labeled \n\"head\" and 8 chips \"tail\". Therefore at each draw, the probability of drawing a \nchip that says \"head\"\" is 20%, and \"tail\" is 80%.\n\n<div id=\"exercise\">\n**Exercise**: In your simulation of flipping the unfair coin 100 times, how many flips came up heads?\n</div>\n\nIn a sense, we've shrunken the size of the slip of paper that says \"heads\", \nmaking it less likely to be drawn and we've increased the size of the slip of \npaper saying \"tails\", making it more likely to be drawn. When we simulated the \nfair coin, both slips of paper were the same size. This happens by default if \nyou don't provide a `prob` argument; all elements in the `outcomes` vector have \nan equal probability of being drawn.\n\nIf you want to learn more about `sample` or any other function, recall that you \ncan always check out its help file with `?sample`.\n\n\n## Simulating the Independent Shooter\n\nSimulating a basketball player who has independent shots uses the same mechanism \nthat we use to simulate a coin flip. To simulate a single shot from an \nindependent shooter with a shooting percentage of 50% we type,\n\n```{r sim-basket}\nshot_outcomes <- c(\"H\", \"M\")\nsim_basket <- sample(shot_outcomes, size = 1, replace = TRUE)\n```\n\nTo make a valid comparison between Kobe and our simulated independent shooter, \nwe need to align both their shooting percentage and the number of attempted shots.\n\n\n<div id=\"exercise\">\n**Exercise**: What change needs to be made to the `sample` function so that it reflects a shooting percentage of 45%? Make this adjustment, then run a simulation to sample 133 shots. Assign the output of this simulation to a new object called `sim_basket`.\n</div>\n   \nNote that we've named the new vector `sim_basket`, the same name that we gave to\nthe previous vector reflecting a shooting percentage of 50%. In this situation, \nR overwrites the old object with the new one, so always make sure that you don't\nneed the information in an old vector before reassigning its name.\n\nWith the results of the simulation saved as `sim_basket`, we have the data \nnecessary to compare Kobe to our independent shooter.\n\nBoth data sets represent the results of 133 shot attempts, each with the same \nshooting percentage of 45%. We know that our simulated data is from a shooter \nthat has independent shots. That is, we know the simulated shooter does not have\na hot hand.\n\n### Comparing Kobe Bryant to the Independent Shooter\n\n<div id=\"exercise\">\n**Exercise**: Using `calc_streak`, compute the streak lengths of `sim_basket`, and save the results in a data frame called `sim_streak`. Note that since the `sim_streak` object is just a vector and not a variable in a data frame, we don't need to first select it from a data frame like we did earlier when we calculated the streak lengths for Kobe's shots.\n</div>\n```{r sim-streak-lengths}\nhm = c(\"H\",\"M\")\nsim_basket = sample( hm, size = 133, replace = TRUE, prob = c(0.45, 0.55) )\nsim_streak = calc_streak( sim_basket )\n```\n   \n<div id=\"exercise\">\n**Exercise**: Make a plot of the distribution of simulated streak lengths of the independent shooter. What is the typical streak length for this simulated independent shooter with a 45% shooting percentage? How long is the player's longest streak of baskets in 133 shots?\n</div>\n```{r plot-sim-streaks}\nggplot(data = sim_streak, aes(x = length, fill = length)) +\n  geom_histogram(binwidth = 1, aes( fill = length ) )\n```\n\n4.  If you were to run the simulation of the independent shooter a second time, how \nwould you expect its streak distribution to compare to the distribution from the \nexercise above? \n<ol>\n<li> Exactly the same  </li>\n<li> Somewhat similar </li>\n<li> Totally different </li>\n</ol>\n\n\n5.  How does Kobe Bryant's distribution of streak lengths compare to the distribution \nof streak lengths for the simulated shooter? Using this comparison, do you have \nevidence that the hot hand model fits Kobe's shooting patterns?\n<ol>\n<li> The distributions look very similar. Therefore, there doesn't appear to be evidence for Kobe Bryant's hot hand. </li>\n<li> The distributions look very similar. Therefore, there appears to be evidence for Kobe Bryant's hot hand. </li>\n<li> The distributions look very different. Therefore, there doesn't appear to be evidence for Kobe Bryant's hot hand. </li>\n<li> The distributions look very different. Therefore, there appears to be evidence for Kobe Bryant's hot hand. </li>\n</ol>\n\n'\n```{r plot-compare}\nkobe_streak$group = rep( \"Kobe\", nrow)\nsim_streak$group  = rep( \"Sim\", nrow( sim_streak) )\ndf = rbind( kobe_streak, sim_streak )\ndf %>% group_by( group ) %>% ggplot( aes( x = length, fill = group, group = group ) ) + geom_bar(position=\"dodge\",stat=\"count\")\n```\n'\n\n<div id=\"exercise\">\n**Exercise**: What concepts from the course videos are covered in this lab? What \nconcepts, if any, are not covered in the videos? Have you seen these concepts \nelsewhere, e.g. textbook, previous labs, or practice problems?\n</div>\n\n<div id=\"license\">\nThis is a derivative of an [OpenIntro](https://www.openintro.org/stat/labs.php) lab, and is released under a [Attribution-NonCommercial-ShareAlike 3.0 United States](https://creativecommons.org/licenses/by-nc-sa/3.0/us/) license.\n</div>",
    "created" : 1467955920306.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3586071815",
    "id" : "98103966",
    "lastKnownWriteTime" : 1467966128,
    "last_content_update" : 1467966128573,
    "path" : "~/GitHub/stats_with_r/intro_to_prob_and_data/week3_lab/probability_Coursera.Rmd",
    "project_path" : "week3_lab/probability_Coursera.Rmd",
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}